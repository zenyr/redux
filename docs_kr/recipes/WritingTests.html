<!DOCTYPE HTML>
<html lang="kr" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>테스트 작성(미번역) | Redux</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.3.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-edit-link/plugin.css">
        
    
    

        
    
    
    <link rel="next" href="../../docs_kr/Troubleshooting.html" />
    
    
    <link rel="prev" href="../../docs_kr/recipes/ComputingDerivedData.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="5.5" data-basepath="../.." data-revision="Mon Sep 14 2015 15:36:31 GMT+0900 (KST)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="검색어 입력" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        소개
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Read Me
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="docs_kr/introduction/index.html">
            
                
                    <a href="../../docs_kr/introduction/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        소개
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="docs_kr/introduction/Motivation.html">
            
                
                    <a href="../../docs_kr/introduction/Motivation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        동기(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="docs_kr/introduction/ThreePrinciples.html">
            
                
                    <a href="../../docs_kr/introduction/ThreePrinciples.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        3가지 원칙(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="docs_kr/introduction/PriorArt.html">
            
                
                    <a href="../../docs_kr/introduction/PriorArt.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        기존 기술들(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="docs_kr/introduction/Ecosystem.html">
            
                
                    <a href="../../docs_kr/introduction/Ecosystem.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        생태계(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="docs_kr/introduction/Examples.html">
            
                
                    <a href="../../docs_kr/introduction/Examples.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        예시(미번역)
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="docs_kr/basics/index.html">
            
                
                    <a href="../../docs_kr/basics/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        기초
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="docs_kr/basics/Actions.html">
            
                
                    <a href="../../docs_kr/basics/Actions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        액션
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="docs_kr/basics/Reducers.html">
            
                
                    <a href="../../docs_kr/basics/Reducers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        리듀서
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="docs_kr/basics/Store.html">
            
                
                    <a href="../../docs_kr/basics/Store.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        스토어
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="docs_kr/basics/DataFlow.html">
            
                
                    <a href="../../docs_kr/basics/DataFlow.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        데이터 흐름
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="docs_kr/basics/UsageWithReact.html">
            
                
                    <a href="../../docs_kr/basics/UsageWithReact.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        React와 함께 사용하기
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="docs_kr/basics/ExampleTodoList.html">
            
                
                    <a href="../../docs_kr/basics/ExampleTodoList.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        예시: Todo List
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="docs_kr/advanced/index.html">
            
                
                    <a href="../../docs_kr/advanced/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        심화
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="docs_kr/advanced/Middleware.html">
            
                
                    <a href="../../docs_kr/advanced/Middleware.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        미들웨어
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="docs_kr/advanced/AsyncActions.html">
            
                
                    <a href="../../docs_kr/advanced/AsyncActions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        비동기 액션(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="docs_kr/advanced/AsyncFlow.html">
            
                
                    <a href="../../docs_kr/advanced/AsyncFlow.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        비동기 흐름(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" >
            
            <span><b>4.4.</b> React Router와 함께 사용하기</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="docs_kr/advanced/ExampleRedditAPI.html">
            
                
                    <a href="../../docs_kr/advanced/ExampleRedditAPI.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        예시: Reddit API(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" >
            
            <span><b>4.6.</b> 다음 단계</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="docs_kr/recipes/index.html">
            
                
                    <a href="../../docs_kr/recipes/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        레시피
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="docs_kr/recipes/MigratingToRedux.html">
            
                
                    <a href="../../docs_kr/recipes/MigratingToRedux.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Redux로 마이그레이션(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="docs_kr/recipes/ReducingBoilerplate.html">
            
                
                    <a href="../../docs_kr/recipes/ReducingBoilerplate.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        보일러플레이트 줄이기(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="docs_kr/recipes/ServerRendering.html">
            
                
                    <a href="../../docs_kr/recipes/ServerRendering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        서버 렌더링(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="docs_kr/recipes/ComputingDerivedData.html">
            
                
                    <a href="../../docs_kr/recipes/ComputingDerivedData.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        파생된 데이터 다루기(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="5.5" data-path="docs_kr/recipes/WritingTests.html">
            
                
                    <a href="../../docs_kr/recipes/WritingTests.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        테스트 작성(미번역)
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="docs_kr/Troubleshooting.html">
            
                
                    <a href="../../docs_kr/Troubleshooting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        문제해결(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="docs_kr/Glossary.html">
            
                
                    <a href="../../docs_kr/Glossary.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        용어사전(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="docs_kr/api/index.html">
            
                
                    <a href="../../docs_kr/api/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        API 레퍼런스
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="docs_kr/api/createStore.html">
            
                
                    <a href="../../docs_kr/api/createStore.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        createStore(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="docs_kr/api/Store.html">
            
                
                    <a href="../../docs_kr/api/Store.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Store(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="docs_kr/api/combineReducers.html">
            
                
                    <a href="../../docs_kr/api/combineReducers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        combineReducers(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="docs_kr/api/applyMiddleware.html">
            
                
                    <a href="../../docs_kr/api/applyMiddleware.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        applyMiddleware(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="docs_kr/api/bindActionCreators.html">
            
                
                    <a href="../../docs_kr/api/bindActionCreators.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        bindActionCreators(미번역)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="docs_kr/api/compose.html">
            
                
                    <a href="../../docs_kr/api/compose.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        compose(미번역)
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="PATRONS.html">
            
                
                    <a href="../../PATRONS.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        후원자(미번역)
                    </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                에 게시 GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="차례"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="수색"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="글꼴 설정"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">화이트</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">밤</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="몫"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    공유 Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    공유 Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    공유 Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    공유 Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    공유 Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Redux</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <a id="edit-link" href="https://github.com/dobbit/redux/tree/master/docs_kr/recipes/WritingTests.md" class="btn fa fa-edit pull-left">&nbsp;&nbsp;Edit This Page</a><h1 id="writing-tests">Writing Tests</h1>
<p>Because most of the Redux code you write are functions, and many of them are pure, they are easy test without mocking.</p>
<h3 id="setting-up">Setting Up</h3>
<p>We recommend <a href="http://mochajs.org/" target="_blank">Mocha</a> as the testing engine.<br>Note that it runs in a Node environment, so you won&#x2019;t have access to DOM.</p>
<pre><code>npm install --save-dev mocha
</code></pre><p>To use it together with <a href="http://babeljs.io" target="_blank">Babel</a>, add this to <code>scripts</code> in your <code>package.json</code>:</p>
<pre><code class="lang-js">{
  ...
  <span class="hljs-string">&quot;scripts&quot;</span>: {
    ...
    <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;mocha --compilers js:babel/register --recursive&quot;</span>,
    <span class="hljs-string">&quot;test:watch&quot;</span>: <span class="hljs-string">&quot;npm test -- --watch&quot;</span>,
  },
  ...
}
</code></pre>
<p>and run <code>npm test</code> to run it once, or <code>npm run test:watch</code> to test on every file change.</p>
<h3 id="action-creators">Action Creators</h3>
<p>In Redux, action creators are functions which return plain objects. When testing action creators we want to test whether the correct action creator was called and also whether the right action was returned.</p>
<h4 id="example">Example</h4>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTodo</span>(<span class="hljs-params">text</span>) </span>{
  <span class="hljs-keyword">return</span> {
    type: <span class="hljs-string">&apos;ADD_TODO&apos;</span>,
    text
  };
}
</code></pre>
<p>can be tested like:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;expect&apos;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../actions/TodoActions&apos;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../constants/ActionTypes&apos;</span>;

describe(<span class="hljs-string">&apos;actions&apos;</span>, () =&gt; {
  it(<span class="hljs-string">&apos;should create an action to add a todo&apos;</span>, () =&gt; {
    <span class="hljs-keyword">const</span> text = <span class="hljs-string">&apos;Finish docs&apos;</span>;
    <span class="hljs-keyword">const</span> expectedAction = {
      type: types.ADD_TODO,
      text
    };
    expect(actions.addTodo(text)).toEqual(expectedAction);
  });
});
</code></pre>
<h3 id="reducers">Reducers</h3>
<p>A reducer should return the new state after applying the action to the previous state, and that&#x2019;s the behavior tested below.</p>
<h4 id="example">Example</h4>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { ADD_TODO } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../constants/ActionTypes&apos;</span>;

<span class="hljs-keyword">const</span> initialState = [{
  text: <span class="hljs-string">&apos;Use Redux&apos;</span>,
  completed: <span class="hljs-literal">false</span>,
  id: <span class="hljs-number">0</span>
}];

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">todos</span>(<span class="hljs-params">state = initialState, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
  <span class="hljs-keyword">case</span> ADD_TODO:
    <span class="hljs-keyword">return</span> [{
      id: state.reduce((maxId, todo) =&gt; <span class="hljs-built_in">Math</span>.max(todo.id, maxId), -<span class="hljs-number">1</span>) + <span class="hljs-number">1</span>,
      completed: <span class="hljs-literal">false</span>,
      text: action.text
    }, ...state];

  <span class="hljs-keyword">default</span>:
    <span class="hljs-keyword">return</span> state;
  }
}
</code></pre>
<p>can be tested like:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;expect&apos;</span>;
<span class="hljs-keyword">import</span> reducer <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../reducers/todos&apos;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../constants/ActionTypes&apos;</span>;

describe(<span class="hljs-string">&apos;todos reducer&apos;</span>, () =&gt; {
  it(<span class="hljs-string">&apos;should return the initial state&apos;</span>, () =&gt; {
    expect(
      reducer(<span class="hljs-literal">undefined</span>, {})
    ).toEqual([{
      text: <span class="hljs-string">&apos;Use Redux&apos;</span>,
      completed: <span class="hljs-literal">false</span>,
      id: <span class="hljs-number">0</span>
    }]);
  });

  it(<span class="hljs-string">&apos;should handle ADD_TODO&apos;</span>, () =&gt; {
    expect(
      reducer([], {
        type: types.ADD_TODO,
        text: <span class="hljs-string">&apos;Run the tests&apos;</span>
      })
    ).toEqual([{
      text: <span class="hljs-string">&apos;Run the tests&apos;</span>,
      completed: <span class="hljs-literal">false</span>,
      id: <span class="hljs-number">0</span>
    }]);

    expect(
      reducer([{
        text: <span class="hljs-string">&apos;Use Redux&apos;</span>,
        completed: <span class="hljs-literal">false</span>,
        id: <span class="hljs-number">0</span>
      }], {
        type: types.ADD_TODO,
        text: <span class="hljs-string">&apos;Run the tests&apos;</span>
      })
    ).toEqual([{
      text: <span class="hljs-string">&apos;Run the tests&apos;</span>,
      completed: <span class="hljs-literal">false</span>,
      id: <span class="hljs-number">1</span>
    }, {
      text: <span class="hljs-string">&apos;Use Redux&apos;</span>,
      completed: <span class="hljs-literal">false</span>,
      id: <span class="hljs-number">0</span>
    }]);
  });
</code></pre>
<h3 id="components">Components</h3>
<p>A nice thing about React components is that they are usually small and only rely on their props. That makes them easy to test.</p>
<p>To test the components we make a <code>setup()</code> helper that passes the stubbed callbacks as props and renders the component with <a href="https://facebook.github.io/react/docs/test-utils.html#shallow-rendering" target="_blank">React shallow renderer</a>. This lets individual tests assert on whether the callbacks were called when expected.</p>
<h4 id="example">Example</h4>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropTypes, Component } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span>;
<span class="hljs-keyword">import</span> TodoTextInput <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./TodoTextInput&apos;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Header</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  handleSave(text) {
    <span class="hljs-keyword">if</span> (text.length !== <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.props.addTodo(text);
    }
  }

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">header</span> <span class="hljs-attribute">className</span>=<span class="hljs-value">&apos;header&apos;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>todos<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-title">TodoTextInput</span> <span class="hljs-attribute">newTodo</span>=<span class="hljs-value">{true}</span>
                         <span class="hljs-attribute">onSave</span>=<span class="hljs-value">{this.handleSave.bind(this)}</span>
                         <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&apos;What needs to be done?&apos;</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">header</span>&gt;</span>
    )</span>;
  }
}

Header.propTypes = {
  addTodo: PropTypes.func.isRequired
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Header;
</code></pre>
<p>can be tested like:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;expect&apos;</span>;
<span class="hljs-keyword">import</span> jsdomReact <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../jsdomReact&apos;</span>;
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react/addons&apos;</span>;
<span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../components/Header&apos;</span>;
<span class="hljs-keyword">import</span> TodoTextInput <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../components/TodoTextInput&apos;</span>;

<span class="hljs-keyword">const</span> { TestUtils } = React.addons;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> props = {
    addTodo: expect.createSpy()
  };

  <span class="hljs-keyword">let</span> renderer = TestUtils.createRenderer();
  renderer.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">Header</span> {<span class="hljs-attribute">...props</span>} /&gt;</span>)</span>;
  <span class="hljs-keyword">let</span> output = renderer.getRenderOutput();

  <span class="hljs-keyword">return</span> {
    props,
    output,
    renderer
  };
}

describe(<span class="hljs-string">&apos;components&apos;</span>, () =&gt; {
  jsdomReact();

  describe(<span class="hljs-string">&apos;Header&apos;</span>, () =&gt; {
    it(<span class="hljs-string">&apos;should render correctly&apos;</span>, () =&gt; {
      <span class="hljs-keyword">const</span> { output } = setup();

      expect(output.type).toBe(<span class="hljs-string">&apos;header&apos;</span>);
      expect(output.props.className).toBe(<span class="hljs-string">&apos;header&apos;</span>);

      <span class="hljs-keyword">let</span> [h1, input] = output.props.children;

      expect(h1.type).toBe(<span class="hljs-string">&apos;h1&apos;</span>);
      expect(h1.props.children).toBe(<span class="hljs-string">&apos;todos&apos;</span>);

      expect(input.type).toBe(TodoTextInput);
      expect(input.props.newTodo).toBe(<span class="hljs-literal">true</span>);
      expect(input.props.placeholder).toBe(<span class="hljs-string">&apos;What needs to be done?&apos;</span>);
    });

    it(<span class="hljs-string">&apos;should call addTodo if length of text is greater than 0&apos;</span>, () =&gt; {
      <span class="hljs-keyword">const</span> { output, props } = setup();
      <span class="hljs-keyword">let</span> input = output.props.children[<span class="hljs-number">1</span>];
      input.props.onSave(<span class="hljs-string">&apos;&apos;</span>);
      expect(props.addTodo.calls.length).toBe(<span class="hljs-number">0</span>);
      input.props.onSave(<span class="hljs-string">&apos;Use Redux&apos;</span>);
      expect(props.addTodo.calls.length).toBe(<span class="hljs-number">1</span>);
    });
  });
});
</code></pre>
<h4 id="fixing-broken-setstate">Fixing Broken <code>setState()</code></h4>
<p>Shallow rendering currently <a href="https://github.com/facebook/react/issues/4019" target="_blank">throws an error if <code>setState</code> is called</a>. React seems to expect that, if you use <code>setState</code>, DOM is available. To work around the issue, we use jsdom so React doesn&#x2019;t throw the exception when DOM isn&#x2019;t available. Here&#x2019;s how to set it up:</p>
<pre><code>npm install --save-dev jsdom mocha-jsdom
</code></pre><p>Then add a <code>jsdomReact()</code> helper function that looks like this:  </p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> ExecutionEnvironment <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react/lib/ExecutionEnvironment&apos;</span>;
<span class="hljs-keyword">import</span> jsdom <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;mocha-jsdom&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsdomReact</span>(<span class="hljs-params"></span>) </span>{
  jsdom();
  ExecutionEnvironment.canUseDOM = <span class="hljs-literal">true</span>;
}
</code></pre>
<p>Call it before running any component tests. Note this is a dirty workaround, and it can be removed once <a href="https://github.com/facebook/react/issues/4019" target="_blank">facebook/react#4019</a> is fixed.</p>
<h3 id="connected-components">Connected Components</h3>
<p>If you use a library like <a href="https://github.com/rackt/react-redux" target="_blank">React Redux</a>, you might be using <a href="https://medium.com/@dan_abramov/mixins-are-dead-long-live-higher-order-components-94a0d2f9e750" target="_blank">higher-order components</a> like <a href="https://github.com/rackt/react-redux#connectmapstatetoprops-mapdispatchtoprops-mergeprops" target="_blank"><code>connect()</code></a>. This lets you inject Redux state into a regular React component.</p>
<p>Consider the following <code>App</code> component:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-redux&apos;</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{ <span class="hljs-comment">/* ... */</span> }

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps)(App);
</code></pre>
<p>In a unit test, you would normally import the <code>App</code> component like this:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./App&apos;</span>;
</code></pre>
<p>However when you import it, you&#x2019;re actually holding the wrapper component returned by <code>connect()</code>, and not the <code>App</code> component itself. If you want to test its interaction with Redux, this is good news: you can wrap it in a <a href="https://github.com/rackt/react-redux#provider-store" target="_blank"><code>&lt;Provider&gt;</code></a> with a store created specifically for this unit test. But sometimes you want to test just the rendering of the component, without a Redux store.</p>
<p>In order to be able to test the App component itself without having to deal with the decorator, we recommend you to also export the undecorated component:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-redux&apos;</span>;

<span class="hljs-comment">// Use named export for unconnected component (for tests)</span>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{ <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// Use default export for the connected component (for app)</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapDispatchToProps)(App);
</code></pre>
<p>Since the default export is still the decorated component, the import statement pictured above will work as before so you won&#x2019;t have to change your application code. However, you can now import the undecorated <code>App</code> components in your test file like this:</p>
<pre><code class="lang-js"><span class="hljs-comment">// Note the curly brances: grab the named export instead of default export</span>
<span class="hljs-keyword">import</span> { App } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./App&apos;</span>;
</code></pre>
<p>And if you need both:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> ConnectedApp, { App } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./App&apos;</span>;
</code></pre>
<p>In the app itself, you would still import it normally:</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./App&apos;</span>;
</code></pre>
<p>You would only use the named export for tests.</p>
<blockquote>
<h5 id="a-note-on-mixing-es6-modules-and-commonjs">A Note on Mixing ES6 Modules and CommonJS</h5>
<p>If you are using ES6 in your application source, but write your tests in ES5, you should know that Babel handles the interchangeable use of ES6 <code>import</code> and CommonJS <code>require</code> through its <a href="http://babeljs.io/docs/usage/modules/#interop" target="_blank">interop</a> capability to run two module formats side-by-side, but the behavior is <a href="https://github.com/babel/babel/issues/2047" target="_blank">slightly different</a>. If you add a second export beside your default export, you can no longer import the default using <code>require(&apos;./App&apos;)</code>. Instead you have to use <code>require(&apos;./App&apos;).default</code>.</p>
</blockquote>
<h3 id="middleware">Middleware</h3>
<p>Middleware functions wrap behavior of <code>dispatch</code> calls in Redux, so to test this modified behavior we need to mock the behavior of the <code>dispatch</code> call.</p>
<h4 id="example">Example</h4>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> expect <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;expect&apos;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> types <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../constants/ActionTypes&apos;</span>;
<span class="hljs-keyword">import</span> singleDispatch <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../../middleware/singleDispatch&apos;</span>;

<span class="hljs-keyword">const</span> fakeStore = fakeData =&gt; ({
  getState() {
    <span class="hljs-keyword">return</span> fakeData;
  }
});

<span class="hljs-keyword">const</span> dispatchWithStoreOf = (storeData, action) =&gt; {
  <span class="hljs-keyword">let</span> dispatched = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> dispatch = singleDispatch(fakeStore(storeData))(actionAttempt =&gt; dispatched = actionAttempt);
  dispatch(action);
  <span class="hljs-keyword">return</span> dispatched;
};

describe(<span class="hljs-string">&apos;middleware&apos;</span>, () =&gt; {
  it(<span class="hljs-string">&apos;should dispatch if store is empty&apos;</span>, () =&gt; {
    <span class="hljs-keyword">const</span> action = {
      type: types.ADD_TODO
    };

    expect(
      dispatchWithStoreOf({}, action)
    ).toEqual(action);
  });

  it(<span class="hljs-string">&apos;should not dispatch if store already has type&apos;</span>, () =&gt; {
    <span class="hljs-keyword">const</span> action = {
      type: types.ADD_TODO
    };

    expect(
      dispatchWithStoreOf({
        [types.ADD_TODO]: <span class="hljs-string">&apos;dispatched&apos;</span>
      }, action)
    ).toNotExist();
  });
});
</code></pre>
<h3 id="glossary">Glossary</h3>
<ul>
<li><p><a href="http://facebook.github.io/react/docs/test-utils.html" target="_blank">React Test Utils</a>: Test utilities that ship with React.</p>
</li>
<li><p><a href="https://github.com/tmpvar/jsdom" target="_blank">jsdom</a>: A plain JavaScript implementation of the DOM API. jsdom allows us to run the tests without browser.</p>
</li>
<li><p><a href="http://facebook.github.io/react/docs/test-utils.html#shallow-rendering" target="_blank">Shallow rendering</a>: Shallow rendering lets you instantiate a component and get the result of its <code>render</code> method just a single level deep instead of rendering components recursively to a DOM. The result of shallow rendering is a <a href="https://facebook.github.io/react/docs/glossary.html#react-elements" target="_blank">ReactElement</a>. That means it is possible to access its children, props and test if it works as expected. This also means that you changing a child component won&#x2019;t affect the tests for parent component.</p>
</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../docs_kr/recipes/ComputingDerivedData.html" class="navigation navigation-prev " aria-label="Previous page: 파생된 데이터 다루기(미번역)"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../docs_kr/Troubleshooting.html" class="navigation navigation-next " aria-label="Next page: 문제해결(미번역)"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-edit-link/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"edit-link":{"base":"https://github.com/dobbit/redux/tree/master","label":"Edit This Page"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
